SPYDER PROTOCOL

----------------

All integer values have little-endianness

----------------

ReplyCode packet:

 +--------+---------+----------------+
 |  NAME  |  SIZE   | VALUE / FORMAT |
 +--------+---------+----------------+
 | Header | 4 bytes |       1        |
 +--------+---------+----------------+
 | Code   | 4 bytes |      `1        |
 +--------+---------+----------------+

----------------

End packet:

 +--------+---------+----------------+
 |  NAME  |  SIZE   | VALUE / FORMAT |
 +--------+---------+----------------+
 | Header | 4 bytes |       2        |
 +--------+---------+----------------+

----------------

RawData packet:

 +----------------+--------------+----------------+
 |      NAME      |     SIZE     | VALUE / FORMAT |
 +----------------+--------------+----------------+
 | Header         | 4 bytes      |       3        |
 +----------------+--------------+----------------+
 | ExpectedSize   | 4 bytes      |    integer     |
 +----------------+--------------+----------------+
 | Data           | ExpectedSize |     bytes      |
 +----------------+--------------+----------------+

 ----------------

Handshake packet:

 +---------------------+----------+----------------+
 |         NAME        |   SIZE   | VALUE / FORMAT |
 +---------------------+----------+----------------+
 | Header              | 4 bytes  |       4        |
 +---------------------+----------+----------------+
 | MacAddress          | 6 bytes  |     bytes      |
 +---------------------+----------+----------------+
 | ClientVersionNumber | 2 bytes  |     short      |
 +---------------------+----------+----------------+
 | ClientHash          | 16 bytes |      md5       |
 +---------------------+----------+----------------+
 | ClientPort          | 2 bytes  |     short      |
 +---------------------+----------+----------------+

 ----------------

KeyEvent packet:

 +-----------+---------+----------------+
 |    NAME   |  SIZE   | VALUE / FORMAT |
 +-----------+---------+----------------+
 | Header    | 4 bytes |       5        |
 +-----------+---------+----------------+
 | Timestamp | 8 bytes |     bytes      |
 +-----------+---------+----------------+
 | KeyCode   | 4 bytes |    KeyType     |
 +-----------+---------+----------------+
 | State     | 4 bytes |    unsigned    |
 +-----------+---------+----------------+

 ----------------

MouseClick packet:

 +-----------+---------+----------------+
 |    NAME   |  SIZE   | VALUE / FORMAT |
 +-----------+---------+----------------+
 | Header    | 4 bytes |       6        |
 +-----------+---------+----------------+
 | Timestamp | 8 bytes |     bytes      |
 +-----------+---------+----------------+
 | X         | 4 bytes |    unsigned    |
 +-----------+---------+----------------+
 | Y         | 4 bytes |    unsigned    |
 +-----------+---------+----------------+
 | Button    | 4 bytes |   ButtonType   |
 +-----------+---------+----------------+

 ----------------

MouseMove packet:

 +-----------+---------+----------------+
 |    NAME   |  SIZE   | VALUE / FORMAT |
 +-----------+---------+----------------+
 | Header    | 4 bytes |       7        |
 +-----------+---------+----------------+
 | Timestamp | 8 bytes |     bytes      |
 +-----------+---------+----------------+
 | X         | 4 bytes |    unsigned    |
 +-----------+---------+----------------+
 | Y         | 4 bytes |    unsigned    |
 +-----------+---------+----------------+

 ----------------

ImageData packet:

 +-----------+---------+----------------+
 |    NAME   |  SIZE   | VALUE / FORMAT |
 +-----------+---------+----------------+
 | Header    | 4 bytes |       8        |
 +-----------+---------+----------------+
 | Timestamp | 8 bytes |     bytes      |
 +-----------+---------+----------------+
 | Width     | 4 bytes |    unsigned    |
 +-----------+---------+----------------+
 | Height    | 4 bytes |    unsigned    |
 +-----------+---------+----------------+

 ----------------

StealthMode packet:

 +-----------+---------+----------------+
 |    NAME   |  SIZE   | VALUE / FORMAT |
 +-----------+---------+----------------+
 | Header    | 4 bytes |       9        |
 +-----------+---------+----------------+
 | Timestamp | 4 bytes |      int       |
 +-----------+---------+----------------+
